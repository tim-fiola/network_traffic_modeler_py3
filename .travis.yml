language: python
os: linux
dist: focal
stages:
  - test
  - name: deploy
jobs:
  include:
    - stage: test
      language: python
      dist: focal
      python: 3.6
      install:
      - pip install -r requirements.txt
      - pip install -r requirements_dev.txt
      - pip install .
      script:
      - pytest
      - black .
      after_success: coveralls
    - stage: test
      language: python
      dist: focal
      python: 3.7
      install:
      - pip install -r requirements.txt
      - pip install -r requirements_dev.txt
      - pip install .
      script:
      - pytest
      - black .
      after_success: coveralls
    - stage: test
      language: python
      dist: focal
      python: 3.8
      install:
      - pip install -r requirements.txt
      - pip install -r requirements_dev.txt
      - pip install .
      script:
      - pytest
      - black .
      after_success: coveralls
    - stage: deploy
      if: tag IS present
      deploy:
        provider: pypi
        username: "__token__"
        password:
          secure: "fUIktANqn+x/qWeDSwBtBFKarBNkEghPn40ZhycHeO1KbGuFwODo8ziZMitWV7cxcv8Gh57JrnFcBWXQYytx8M8iUJGldvAEYoR1e4ce1dB/Aqwyd33Tkeh+t8twBuZZD6x4oRxkcFXWOby9Ekz5NBxJXeniRRaY3rwxXRaehBqYHflmpwTgrdmKapGzCkobcKxmtweZtOuxL8HfY2vyCVyBPbahOYhzl1wzHfu4orPuNmRYq1h3x9W7nDxd2tAOHgOggk/hk5Rt1jI7SeTRY9290x6V6uRPtkkNzkbicroFl0j+8EOn8AdfdPYxaA8QKrh1qfbs03vYlNhqH+9KRnUQqKSUccR1uoDoKZY2B9dJx8hZHyI/ORRZxaKjwuDEB7OGx0TXtZK+4vh++CgrrZVxORiJP/6J27eN85whfy/W4X35OaIjG0KO1J5UhJM/cqbgl6qRTRMBIp0Vgz3BX5PsmuVMLwaxnvLIuLskrDIJPNNLN2HdNdshxE2iR8e59AansgsRIxJ1oN1F7/mIfdzoWMMMxaGVBkSQg6Bf7U2jZuyILUPwhYwFl+Ncy+sBAKOXCg/ucU2koWonCO2GkT3JjaB1qcoaiWqbJBeiQ7Jcq2oK7FsPM2LyYTUNNkeJtTOguyCadQ+DGvlpGAmtBZd++IZVLSV9crTSFwDLQ+c="
        skip_existing: true
        distributions: "sdist bdist_wheel"
